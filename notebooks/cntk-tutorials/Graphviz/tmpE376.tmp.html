<!DOCTYPE html>
<meta charset="utf-8">
<div style="display: flex; width: 100%">
  <div id="graph" style="flex-grow: 2; border: solid green 2px;margin: 10px;"></div>
  <div id="info" style="flex-grow: 1; border: solid blue 2px; margin: 10px;"></div>
</div>
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
  integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="http://d3js.org/d3.v5.min.js"></script>
<script src="https://unpkg.com/viz.js@1.8.0/viz.js" type="javascript/worker"></script>
<script src="https://unpkg.com/d3-graphviz@1.3.1/build/d3-graphviz.min.js"></script>
<script>
  var info = {
    "CompositeFunction19": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "Composite(Plus): Input('Features', [2], [*, #]) -> Output('+', [2], [*, #])" }, { "Property": "Name", "Value": "+" }, { "Property": "Uid", "Value": "CompositeFunction19" }, { "Property": "RootFunction", "Value": "fun Plus18" }, { "Property": "Outputs", "Value": "var Plus18_Output_0 Output('+', [2], [*, #])" }, { "Property": "Output", "Value": "var Plus18_Output_0" }, { "Property": "OpName", "Value": "CompositeFunctionOpName" }, { "Property": "IsComposite", "Value": "True" }, { "Property": "IsPrimitive", "Value": "False" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "3" }, { "Property": "Arguments", "Value": "var Input0 Input('Features', [2], [*, #])" }, { "Property": "Inputs", "Value": "var Parameter13 Parameter('Weights', [2 x 5], []), var Parameter2 Parameter('Weights', [5 x 2], []), var Input0 Input('Features', [2], [*, #]), var Parameter3 Parameter('Bias', [5], []), var Parameter14 Parameter('Bias', [2], [])" }],
    "Parameter13": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Parameter('Weights', [2 x 5], [])" }, { "Property": "Shape", "Value": "[2 x 5]" }, { "Property": "Name", "Value": "Weights" }, { "Property": "Uid", "Value": "Parameter13" }, { "Property": "Kind", "Value": "Parameter" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "DynamicAxes: IList`1 -> The input sequence was empty.\r\nParameter name: source" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "False" }, { "Property": "IsParameter", "Value": "True" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "Owner: Function -> Object reference not set to an instance of an object." }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "0" }],
    "Parameter2": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Parameter('Weights', [5 x 2], [])" }, { "Property": "Shape", "Value": "[5 x 2]" }, { "Property": "Name", "Value": "Weights" }, { "Property": "Uid", "Value": "Parameter2" }, { "Property": "Kind", "Value": "Parameter" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "DynamicAxes: IList`1 -> The input sequence was empty.\r\nParameter name: source" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "False" }, { "Property": "IsParameter", "Value": "True" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "Owner: Function -> Object reference not set to an instance of an object." }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "0" }],
    "Input0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Input('Features', [2], [*, #])" }, { "Property": "Shape", "Value": "[2]" }, { "Property": "Name", "Value": "Features" }, { "Property": "Uid", "Value": "Input0" }, { "Property": "Kind", "Value": "Input" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "True" }, { "Property": "IsOutput", "Value": "False" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "Owner: Function -> Object reference not set to an instance of an object." }, { "Property": "NeedsGradient", "Value": "False" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "Parameter3": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Parameter('Bias', [5], [])" }, { "Property": "Shape", "Value": "[5]" }, { "Property": "Name", "Value": "Bias" }, { "Property": "Uid", "Value": "Parameter3" }, { "Property": "Kind", "Value": "Parameter" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "DynamicAxes: IList`1 -> The input sequence was empty.\r\nParameter name: source" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "False" }, { "Property": "IsParameter", "Value": "True" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "Owner: Function -> Object reference not set to an instance of an object." }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "0" }],
    "Parameter14": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Parameter('Bias', [2], [])" }, { "Property": "Shape", "Value": "[2]" }, { "Property": "Name", "Value": "Bias" }, { "Property": "Uid", "Value": "Parameter14" }, { "Property": "Kind", "Value": "Parameter" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "DynamicAxes: IList`1 -> The input sequence was empty.\r\nParameter name: source" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "False" }, { "Property": "IsParameter", "Value": "True" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "Owner: Function -> Object reference not set to an instance of an object." }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "0" }],
    "Plus18_Output_0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Output('+', [2], [*, #])" }, { "Property": "Shape", "Value": "[2]" }, { "Property": "Name", "Value": "+" }, { "Property": "Uid", "Value": "Plus18_Output_0" }, { "Property": "Kind", "Value": "Output" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "True" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "fun Plus18" }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "Plus18": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "Plus: Output('@', [2], [*, #]) -> Output('+', [2], [*, #])" }, { "Property": "Name", "Value": "+" }, { "Property": "Uid", "Value": "Plus18" }, { "Property": "RootFunction", "Value": "fun Plus18" }, { "Property": "Outputs", "Value": "var Plus18_Output_0 Output('+', [2], [*, #])" }, { "Property": "Output", "Value": "var Plus18_Output_0" }, { "Property": "OpName", "Value": "Plus" }, { "Property": "IsComposite", "Value": "False" }, { "Property": "IsPrimitive", "Value": "True" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "24" }, { "Property": "Arguments", "Value": "var Times15_Output_0 Output('@', [2], [*, #])" }, { "Property": "Inputs", "Value": "var Times15_Output_0 Output('@', [2], [*, #]), var Parameter14 Parameter('Bias', [2], [])" }],
    "Times15_Output_0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Output('@', [2], [*, #])" }, { "Property": "Shape", "Value": "[2]" }, { "Property": "Name", "Value": "@" }, { "Property": "Uid", "Value": "Times15_Output_0" }, { "Property": "Kind", "Value": "Output" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "True" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "fun Times15" }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "Times15": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "Times: Output('StableSigmoid10_Output_0', [5], [*, #]) -> Output('@', [2], [*, #])" }, { "Property": "Name", "Value": "@" }, { "Property": "Uid", "Value": "Times15" }, { "Property": "RootFunction", "Value": "fun Times15" }, { "Property": "Outputs", "Value": "var Times15_Output_0 Output('@', [2], [*, #])" }, { "Property": "Output", "Value": "var Times15_Output_0" }, { "Property": "OpName", "Value": "Times" }, { "Property": "IsComposite", "Value": "False" }, { "Property": "IsPrimitive", "Value": "True" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "24" }, { "Property": "Arguments", "Value": "var StableSigmoid10_Output_0 Output('StableSigmoid10_Output_0', [5], [*, #])" }, { "Property": "Inputs", "Value": "var Parameter13 Parameter('Weights', [2 x 5], []), var StableSigmoid10_Output_0 Output('StableSigmoid10_Output_0', [5], [*, #])" }],
    "StableSigmoid10_Output_0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Output('StableSigmoid10_Output_0', [5], [*, #])" }, { "Property": "Shape", "Value": "[5]" }, { "Property": "Name", "Value": "" }, { "Property": "Uid", "Value": "StableSigmoid10_Output_0" }, { "Property": "Kind", "Value": "Output" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "True" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "fun StableSigmoid10" }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "StableSigmoid10": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "StableSigmoid: Output('+', [5], [*, #]) -> Output('StableSigmoid10_Output_0', [5], [*, #])" }, { "Property": "Name", "Value": "" }, { "Property": "Uid", "Value": "StableSigmoid10" }, { "Property": "RootFunction", "Value": "fun StableSigmoid10" }, { "Property": "Outputs", "Value": "var StableSigmoid10_Output_0 Output('StableSigmoid10_Output_0', [5], [*, #])" }, { "Property": "Output", "Value": "var StableSigmoid10_Output_0" }, { "Property": "OpName", "Value": "StableSigmoid" }, { "Property": "IsComposite", "Value": "False" }, { "Property": "IsPrimitive", "Value": "True" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "24" }, { "Property": "Arguments", "Value": "var Plus7_Output_0 Output('+', [5], [*, #])" }, { "Property": "Inputs", "Value": "var Plus7_Output_0 Output('+', [5], [*, #])" }],
    "Plus7_Output_0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Output('+', [5], [*, #])" }, { "Property": "Shape", "Value": "[5]" }, { "Property": "Name", "Value": "+" }, { "Property": "Uid", "Value": "Plus7_Output_0" }, { "Property": "Kind", "Value": "Output" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "True" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "fun Plus7" }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "Plus7": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "Plus: Output('@', [5], [*, #]) -> Output('+', [5], [*, #])" }, { "Property": "Name", "Value": "+" }, { "Property": "Uid", "Value": "Plus7" }, { "Property": "RootFunction", "Value": "fun Plus7" }, { "Property": "Outputs", "Value": "var Plus7_Output_0 Output('+', [5], [*, #])" }, { "Property": "Output", "Value": "var Plus7_Output_0" }, { "Property": "OpName", "Value": "Plus" }, { "Property": "IsComposite", "Value": "False" }, { "Property": "IsPrimitive", "Value": "True" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "24" }, { "Property": "Arguments", "Value": "var Times4_Output_0 Output('@', [5], [*, #])" }, { "Property": "Inputs", "Value": "var Times4_Output_0 Output('@', [5], [*, #]), var Parameter3 Parameter('Bias', [5], [])" }],
    "Times4_Output_0": [{ "Property": "Type", "Value": "CNTK.Variable" }, { "Property": "AsString", "Value": "Output('@', [5], [*, #])" }, { "Property": "Shape", "Value": "[5]" }, { "Property": "Name", "Value": "@" }, { "Property": "Uid", "Value": "Times4_Output_0" }, { "Property": "Kind", "Value": "Output" }, { "Property": "DataType", "Value": "Float" }, { "Property": "DynamicAxes", "Value": "Axis('defaultDynamicAxis'), Axis('defaultBatchAxis')" }, { "Property": "IsSparse", "Value": "False" }, { "Property": "IsInput", "Value": "False" }, { "Property": "IsOutput", "Value": "True" }, { "Property": "IsParameter", "Value": "False" }, { "Property": "IsConstant", "Value": "False" }, { "Property": "IsPlaceholder", "Value": "False" }, { "Property": "Owner", "Value": "fun Times4" }, { "Property": "NeedsGradient", "Value": "True" }, { "Property": "CurrentValueTimeStamp", "Value": "CurrentValueTimeStamp: Int32 -> Exception has been thrown by the target of an invocation." }],
    "Times4": [{ "Property": "Type", "Value": "CNTK.Function" }, { "Property": "AsString()", "Value": "Times: Input('Features', [2], [*, #]) -> Output('@', [5], [*, #])" }, { "Property": "Name", "Value": "@" }, { "Property": "Uid", "Value": "Times4" }, { "Property": "RootFunction", "Value": "fun Times4" }, { "Property": "Outputs", "Value": "var Times4_Output_0 Output('@', [5], [*, #])" }, { "Property": "Output", "Value": "var Times4_Output_0" }, { "Property": "OpName", "Value": "Times" }, { "Property": "IsComposite", "Value": "False" }, { "Property": "IsPrimitive", "Value": "True" }, { "Property": "IsBlock", "Value": "False" }, { "Property": "CurrentVersion", "Value": "24" }, { "Property": "Arguments", "Value": "var Input0 Input('Features', [2], [*, #])" }, { "Property": "Inputs", "Value": "var Parameter2 Parameter('Weights', [5 x 2], []), var Input0 Input('Features', [2], [*, #])" }]
  }

  function writeInfo(uid) {
    let tab = $("<dl class='dl-horizontal'></div>")
    let nodeInfo = info[uid];
    for (let item of nodeInfo) {
      $("<dt>" + item["Property"] + "</dt>").appendTo(tab);
      $("<dd>" + item["Value"] + "</dd>").appendTo(tab);
    }

    $("#info").empty();
    $("#info").append(tab);
  }

  var dot = `
  digraph {
  Input0 -> Times4 [label=input];
  Input0 [label="Features\n[2]"];
	Input0 [shape=invhouse, color=yellow];
	Parameter13 -> Times15 [label="input param"];
	Parameter13 [label="Weights\n[2 x 5]"];
	Parameter13 [shape=diamond, color=green];
	Parameter14 -> Plus18 [label="input param"];
	Parameter14 [label="Bias\n[2]"];
	Parameter14 [shape=diamond, color=green];
	Parameter2 -> Times4 [label="input param"];
	Parameter2 [label="Weights\n[5 x 2]"];
	Parameter2 [shape=diamond, color=green];
	Parameter3 -> Plus7 [label="input param"];
	Parameter3 [label="Bias\n[5]"];
	Parameter3 [shape=diamond, color=green];
	Plus18 -> Plus18_Output_0 [label=output];
	Plus18 [label="+"];
	Plus18 [shape=ellipse, fontsize=20, penwidth=2, size=0.6];
	Plus18_Output_0 [label="+\n[2]"];
	Plus18_Output_0 [shape=invhouse, color=gray];
	Plus7 -> Plus7_Output_0 [label=output];
	Plus7 [label="+"];
	Plus7 [shape=ellipse, fontsize=20, penwidth=2, size=0.6];
	Plus7_Output_0 -> StableSigmoid10 [label=input];
	Plus7_Output_0 [label="+\n[5]"];
	Plus7_Output_0 [shape=invhouse, color=gray];
	StableSigmoid10 -> StableSigmoid10_Output_0 [label=output];
	StableSigmoid10 [label="StableSigmoid10"];
	StableSigmoid10 [shape=ellipse, fontsize=20, penwidth=2, size=0.6];
	StableSigmoid10_Output_0 -> Times15 [label=input];
	StableSigmoid10_Output_0 [label="StableSigmoid10_Output_0\n[5]"];
	StableSigmoid10_Output_0 [shape=invhouse, color=gray];
	Times15 -> Times15_Output_0 [label=output];
	Times15 [label="@"];
	Times15 [shape=ellipse, fontsize=20, penwidth=2, size=0.6];
	Times15_Output_0 -> Plus18 [label=input];
	Times15_Output_0 [label="@\n[2]"];
	Times15_Output_0 [shape=invhouse, color=gray];
	Times4 -> Times4_Output_0 [label=output];
	Times4 [label="@"];
	Times4 [shape=ellipse, fontsize=20, penwidth=2, size=0.6];
	Times4_Output_0 -> Plus7 [label=input];
	Times4_Output_0 [label="@\n[5]"];
	Times4_Output_0 [shape=invhouse, color=gray];

  }`;
  var viz = d3
    .select("#graph")
    .graphviz()
    //.logEvents(true)
    .on("initEnd", function () {

      //viz.engine("circo");
      viz.renderDot(dot)
        .on("end", function () {

          let svg = d3.select("svg");//.attr("width", "1750pt").attr("height","1000pt");

          let defs = svg.append("defs");

          let filter = defs
            .append("filter")
            .attr("id", "shadow")
            .attr("x", "-50%")
            .attr("y", "-50%")
            .attr("width", "200%")
            .attr("height", "200%");

          filter.append("feGaussianBlur")
            .attr("in", "SourceAlpha")
            .attr("stdDeviation", 3)
            .attr("result", "blur");

          filter
            .append("feOffset")
            .attr("in", "blur")
            .attr("dx", 3)
            .attr("dy", 3);

          filter.append("feComponentTransfer")
            .append("feFuncA").attr("type", "linear")
            .attr("slope", 0.35);

          var merge = filter.append("feMerge");
          merge.append("feMergeNode");
          merge.append("feMergeNode").attr("in", "SourceGraphic");

          d3.selectAll(".node ellipse, .node polygon")
            .style("fill", "white")
            .on("mouseover", (d, i, n) => {
              console.log("data:", i, d.id, d.key);
              d3.select(n[i]).style("filter", "url(#shadow)");
            })
            .on("click", (d, i, n) => {
              let uid = d.id.split(".")[2];
              writeInfo(uid);
            })
            .on("mouseout", (d, i, n) => d3.select(n[i]).style("filter", null));
        });
    });
</script>